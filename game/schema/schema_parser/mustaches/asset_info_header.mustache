/////////////////////////////////////////////////////////////////////
/// WARN: THIS FILE GENERATED BY schema_parser, DONT CHANGE IT!!! ///
/////////////////////////////////////////////////////////////////////

#pragma once
#include <array>
#include <variant>
#include <type_traits>
#include "engine/type_index.hpp"
#include "engine/path.hpp"
#include "cpp_asset_def_extension.hpp"
{{#includes}}
#include "{{include}}"
{{/includes}}
    
template <typename... Args>
struct TypeList {};
    
using AssetTypeList = TypeList<
    {{#asset_names}}
    {{{name}}}
    {{/asset_names}}
>;

namespace internal {
template <typename... Args>
std::variant<std::monostate, Handle<Args>...> VariantAssetTypeGenerator(
    TypeList<Args...>);
}

using VariantAsset = decltype(internal::VariantAssetTypeGenerator(
    AssetTypeList{}));
    
{{#asset_extensions}}
constexpr std::string_view {{extension_var}} = "{{extension}}.xml";
{{/asset_extensions}}

class CommonContext;
    
struct AssetInfoManager {
    template <typename T>
    static std::string_view GetExtension() {
        {{#type_check}}
        if constexpr (std::is_same_v<T, {{type}}>) {
            return {{extension_var}};
        }
        {{/type_check}}
        return {};
    }

    template <typename  T>
    static std::string_view GetExtensionNoDot() {
        std::string_view extension = GetExtension<T>();
        return extension.substr(1);
    }

    template <typename T>
    static std::string_view GetName() {
        {{#type_check}}
        if constexpr (std::is_same_v<T, {{type}}>) {
            return "{{type}}";
        }
        {{/type_check}}
        return {};
    }
    
    static size_t GetNum() {
        return {{asset_num}};
    }

    static VariantAsset LoadAsset(const Path& filename, CommonContext& ctx);

    static constexpr std::array<std::string_view, {{asset_num}}> GetNames() {
        return {
            {{#type_check}}
            "{{type}}",
            {{/type_check}}
        };
    }

    static constexpr std::array<std::string_view, {{asset_num}}> GetExtensions() {
        return {
            {{#extensions}}
            {{extension_var}},
            {{/extensions}}
        };
    }

    static VariantAsset CreateAsset(std::string_view type, CommonContext& ctx);
};
